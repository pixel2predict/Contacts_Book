<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contact Book ‚Äî By Suman Krishna</title>
  <style>
    :root{
      --bg: #0b1020;
      --card: #121936;
      --muted: #9aa3b2;
      --text: #e9ecf1;
      --primary: #6aa8ff;
      --primary-strong:#3d8bff;
      --danger:#ff6b6b;
      --ok:#2ecc71;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Helvetica,Arial,sans-serif;
      background: radial-gradient(1200px 800px at 10% -10%, #1a2758 0%, transparent 50%),
                  radial-gradient(1000px 800px at 110% 10%, #132a54 0%, transparent 50%),
                  var(--bg);
      color:var(--text);
      min-height:100svh;
      display:flex; flex-direction:column;
    }
    header{
      position:sticky; top:0; z-index:10;
      backdrop-filter: blur(10px);
      background: linear-gradient(180deg, rgba(11,16,32,.8), rgba(11,16,32,.4));
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .container{ width: min(1100px, 92%); margin-inline:auto; }
    .topbar{ display:flex; gap:12px; align-items:center; padding:16px 0; }
    h1{ font-size: clamp(22px, 3vw, 28px); margin:0; letter-spacing:.3px; }
    .spacer{ flex:1 }

    .btn{ cursor:pointer; border:none; border-radius:12px; padding:10px 14px; font-weight:600; color:#0b1020; background:var(--primary); box-shadow: var(--shadow); transition: transform .06s ease, background .2s ease; }
    .btn:hover{ background:var(--primary-strong) }
    .btn:active{ transform: translateY(1px) }
    .btn.ghost{ background:transparent; color:var(--text); border:1px solid rgba(255,255,255,.12); box-shadow:none }
    .btn.danger{ background:var(--danger); color:white }
    .btn.ok{ background:var(--ok); color:white }

    .toolbar{ display:grid; grid-template-columns: 1fr auto auto; gap:12px; align-items:center; padding:0 0 18px 0; }

    .search{ position:relative; }
    .search input{
      width:100%; padding:12px 44px 12px 44px; border-radius:12px; border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.06); color:var(--text);
      outline:none; box-shadow: inset 0 0 0 1px transparent; transition: box-shadow .2s ease, background .2s ease;
    }
    .search input:focus{ box-shadow: inset 0 0 0 1px var(--primary); background: rgba(255,255,255,.08) }
    .search .icon{
      position:absolute; left:12px; top:50%; translate:0 -50%; opacity:.7; pointer-events:none; font-size:18px;
    }

    main{ flex:1; padding:24px 0 60px; }

    .card{ background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02)); border:1px solid rgba(255,255,255,.08); border-radius: var(--radius); box-shadow: var(--shadow); }
    .grid{ display:grid; gap:16px; }

    /* Table layout for md+ screens */
    .table{ width:100%; border-collapse:separate; border-spacing:0 10px; }
    .thead, .row{ display:grid; grid-template-columns: 70px 1fr 1.2fr 140px; align-items:center; padding:0 12px; }
    .thead{ color:var(--muted); font-size:14px; padding:8px 12px; }
    .row{
      background: var(--card); border:1px solid rgba(255,255,255,.1); border-radius:14px; padding:12px;
    }
    .cell{ padding:8px 10px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
    .actions{ display:flex; gap:8px; justify-content:flex-end }

    /* Card layout for small screens */
    @media (max-width: 640px){
      .toolbar{ grid-template-columns: 1fr; }
      .thead{ display:none }
      .row{ grid-template-columns: 1fr; gap:10px; }
      .cell.id{ order:3; opacity:.7 }
      .cell.name{ font-weight:700; font-size:18px }
      .cell.phone{ order:2; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
      .actions{ order:4; justify-content:flex-start }
    }

    .empty{ text-align:center; color:var(--muted); padding:40px 16px }

    /* Modal */
    dialog{ border:none; border-radius: 18px; background: var(--card); color:var(--text); width:min(520px, 92%); box-shadow: var(--shadow); }
    dialog::backdrop{ background: rgba(0,0,0,.6) }
    form{ display:grid; gap:14px; }
    label{ font-size:14px; color:var(--muted) }
    input[type="text"], input[type="tel"]{ width:100%; padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.06); color:var(--text); outline:none; }
    input:focus{ box-shadow: inset 0 0 0 1px var(--primary) }
    .row2{ display:grid; grid-template-columns: 1fr 1fr; gap:12px }
    @media (max-width:480px){ .row2{ grid-template-columns: 1fr } }

    .footer{ display:flex; justify-content:flex-end; gap:10px; margin-top:6px }
    .hint{ font-size:12px; color:var(--muted) }

    .pill{ display:inline-flex; align-items:center; gap:8px; font-size:12px; padding:8px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.05) }

    footer{
      text-align:center;
      font-size:14px;
      color:var(--muted);
      padding:20px;
      border-top:1px solid rgba(255,255,255,.08);
      background: rgba(11,16,32,.7);
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="topbar">
        <h1>üìí Contact Book</h1>
        <div class="spacer"></div>
        <button id="addBtn" class="btn">+ Add Contact</button>
      </div>
      <div class="toolbar">
        <div class="search">
          <span class="icon">üîé</span>
          <input id="searchInput" type="text" placeholder="Search by name or phone‚Ä¶"/>
        </div>
        <button id="exportBtn" class="btn ghost" title="Download contacts as JSON">Export</button>
        <label class="btn ghost" for="importFile" title="Import contacts from JSON">Import<input id="importFile" type="file" accept="application/json" hidden></label>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="grid">
      <div class="thead">
        <div class="cell">ID</div>
        <div class="cell">Name</div>
        <div class="cell">Phone</div>
        <div class="cell" style="text-align:right">Actions</div>
      </div>
      <div id="list" class="grid"></div>
      <div id="empty" class="empty" hidden>
        <p>No contacts yet. Click <span class="pill">+ Add Contact</span> to create your first one.</p>
      </div>
    </section>
  </main>

  <footer>
    Made with ‚ù§Ô∏è By Suman Krishna
  </footer>

  <!-- Add/Edit Modal -->
  <dialog id="modal">
    <form id="form" method="dialog">
      <h3 id="modalTitle" style="margin:0 0 4px">Add Contact</h3>
      <div class="hint">Fields marked * are required</div>
      <input type="hidden" id="contactId">
      <div class="row2">
        <div>
          <label for="name">Name *</label>
          <input id="name" type="text" placeholder="e.g., Suman Krishna" required minlength="2" maxlength="60">
        </div>
        <div>
          <label for="phone">Phone *</label>
          <input id="phone" type="tel" placeholder="e.g., 9876543210" required pattern="^[+]?\d[\d\s-]{7,14}$" title="Use digits, optional +, spaces or dashes">
        </div>
      </div>
      <div class="footer">
        <button type="button" class="btn ghost" id="cancelBtn">Cancel</button>
        <button type="submit" class="btn ok" id="saveBtn">Save</button>
      </div>
    </form>
  </dialog>

  <script>
    // ---- Simple localStorage-based store ----
    const KEY = 'contacts.v1';
    const $ = sel => document.querySelector(sel);
    const listEl = $('#list');
    const emptyEl = $('#empty');
    const modal = $('#modal');
    const form = $('#form');
    const addBtn = $('#addBtn');
    const searchInput = $('#searchInput');

    function load(){
      try{ return JSON.parse(localStorage.getItem(KEY)) ?? []; }
      catch{ return []; }
    }
    function save(items){ localStorage.setItem(KEY, JSON.stringify(items)); }

    function uid(){ return Date.now().toString(36) + Math.random().toString(36).slice(2,6); }

    function render(items){
      listEl.innerHTML = '';
      if(!items.length){ emptyEl.hidden = false; return; }
      emptyEl.hidden = true;
      for(const c of items){
        const row = document.createElement('div');
        row.className = 'row';
        row.innerHTML = `
          <div class="cell id">#${c.id.slice(-5)}</div>
          <div class="cell name">${escapeHtml(c.name)}</div>
          <div class="cell phone">${escapeHtml(c.phone)}</div>
          <div class="cell">
            <div class="actions">
              <button class="btn ghost" data-edit="${c.id}">Edit</button>
              <button class="btn danger" data-del="${c.id}">Delete</button>
            </div>
          </div>`;
        listEl.appendChild(row);
      }
    }

    function escapeHtml(str){
      return str.replace(/[&<>"']/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[s]));
    }

    function openModal(mode='add', data=null){
      $('#modalTitle').textContent = mode === 'edit' ? 'Edit Contact' : 'Add Contact';
      if(mode==='edit' && data){
        $('#contactId').value = data.id;
        $('#name').value = data.name;
        $('#phone').value = data.phone;
      } else {
        $('#contactId').value = '';
        form.reset();
      }
      modal.showModal();
      $('#name').focus();
    }

    function closeModal(){ modal.close(); }

    function upsertContact(e){
      e.preventDefault();
      if(!form.reportValidity()) return;
      const id = $('#contactId').value || uid();
      const contact = { id, name: $('#name').value.trim(), phone: $('#phone').value.trim() };
      let items = load();
      const idx = items.findIndex(x => x.id === id);
      if(idx >= 0) items[idx] = contact; else items.push(contact);
      // keep sorted by name
      items.sort((a,b)=> a.name.localeCompare(b.name));
      save(items);
      render(filter(items, searchInput.value));
      closeModal();
    }

    function filter(items, q){
      q = (q||'').toLowerCase().trim();
      if(!q) return items;
      return items.filter(c => c.name.toLowerCase().includes(q) || c.phone.toLowerCase().includes(q));
    }

    // ---- Event wiring ----
    addBtn.addEventListener('click', () => openModal('add'));
    $('#cancelBtn').addEventListener('click', closeModal);
    form.addEventListener('submit', upsertContact);
    searchInput.addEventListener('input', () => { render(filter(load(), searchInput.value)); });

    listEl.addEventListener('click', (e)=>{
      const idDel = e.target.closest('button')?.dataset?.del;
      const idEdit = e.target.closest('button')?.dataset?.edit;
      if(idDel){
        const items = load();
        const item = items.find(x=>x.id===idDel);
        if(item && confirm(`Delete ${item.name}?`)){
          save(items.filter(x=>x.id!==idDel));
          render(filter(load(), searchInput.value));
        }
      }
      if(idEdit){
        const items = load();
        const item = items.find(x=>x.id===idEdit);
        if(item) openModal('edit', item);
      }
    });

    // ---- Import/Export ----
    $('#exportBtn').addEventListener('click', () => {
      const data = new Blob([JSON.stringify(load(), null, 2)], {type:'application/json'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(data);
      a.download = 'contacts.json';
      a.click();
      URL.revokeObjectURL(a.href);
    });

    $('#importFile').addEventListener('change', async (e)=>{
      const file = e.target.files?.[0]; if(!file) return;
      try{
        const text = await file.text();
        const arr = JSON.parse(text);
        if(!Array.isArray(arr)) throw new Error('Invalid format');
        // merge by id, fallback by name+phone
        const existing = load();
        const map = new Map(existing.map(c=>[c.id, c]));
        for(const c of arr){
          if(!c.id) c.id = uid();
          map.set(c.id, {id:c.id, name:String(c.name||'').trim(), phone:String(c.phone||'').trim()});
        }
        const merged = [...map.values()].filter(c=>c.name && c.phone).sort((a,b)=>a.name.localeCompare(b.name));
        save(merged);
        render(filter(merged, searchInput.value));
        alert('Imported contacts successfully.');
      }catch(err){
        alert('Failed to import: '+ err.message);
      } finally {
        e.target.value = '';
      }
    });

    // ---- Init ----
    render(load());
  </script>
</body>
</html>
